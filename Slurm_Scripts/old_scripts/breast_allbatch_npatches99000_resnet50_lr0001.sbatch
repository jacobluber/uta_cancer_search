#!/bin/bash

#SBATCH --job-name=breast_allbatch_npatches99000_resnet50_lr0001
#SBATCH --mail-type=END,FAIL
#SBATCH --mail-user=mohammadsadegh.nasr@uta.edu
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-task=10
#SBATCH --mem=128G
#SBATCH --gres=gpu:2
#SBATCH --time=120:00:00
#SBATCH --error=/home/mxn2498/projects/uta_cancer_search/logs/slurm_logs/breast_allbatch_npatches99000_resnet50_lr0001.err
#SBATCH --output=/home/mxn2498/projects/uta_cancer_search/logs/slurm_logs/breast_allbatch_npatches99000_resnet50_lr0001.out

function fail {
    echo "FAIL: $@" >&2
    exit 1  # signal failure
}

source /home/mxn2498/miniconda3/etc/profile.d/conda.sh || fail "conda load fail"
conda activate vae || fail "conda activate fail"

cd /home/mxn2498/projects/uta_cancer_search/


python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch32_latent8_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch32_latent8_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 32 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 8 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch32_latent16_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch32_latent16_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 32 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 16 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch32_latent32_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch32_latent32_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 32 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 32 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch32_latent64_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch32_latent64_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 32 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 64 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"

python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch128_latent8_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch128_latent8_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 128 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 8 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch128_latent16_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch128_latent16_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 128 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 16 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch128_latent32_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch128_latent32_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 128 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 32 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch128_latent64_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch128_latent64_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 128 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 64 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"

python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch256_latent8_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch256_latent8_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 256 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 8 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch256_latent16_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch256_latent16_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 256 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 16 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch256_latent32_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch256_latent32_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 256 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 32 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
python /home/mxn2498/projects/uta_cancer_search/main_gdc.py --everything_seed 0 --test_random_seed 1 --train_val_random_seed 2 --pathcing_seed 3 --logging_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs --logging_name breast_batch256_latent64_npatches99000_resnet50_lr0001 --inv_transformations_read_dir /home/mxn2498/projects/uta_cancer_search/logs/tb_logs/breast_batch256_latent64_npatches99000_resnet50_lr0001 --cancer_type Breast --ratio_per_type 1 --split_ratio 0.9 0.05 0.05 --patch_size 64 --num_patches_per_image 200 --num_dataset_workers 8 --coords_read_dir /home/mxn2498/projects/uta_cancer_search/logs/coords/breast_patchsize64_npathces99000 --batch_size 256 --num_dataloader_workers 8 --normalize_transform --input_height 64 --enc_type resnet50 --enc_out_dim 2048 --latent_dim 64 --lr 0.0001 --gradient_clip_val 0.5 --num_nodes 1 --strategy ddp --accelerator gpu --devices 2 --max_epochs 100 --auto_lr_find False --benchmark True --fast_dev_run False || fail "python fail"
